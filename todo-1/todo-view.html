<link is="pulp-import" href="/!/iron-elements/flex-layout/layout.html">

<link is="pulp-import" href="/!/paper-elements/paper-menu.html">
<link is="pulp-import" href="/!/paper-elements/paper-icon-button.html">

<link is="pulp-import" href="/!/x-drawer-layout/x-drawer-layout.html">
<link is="pulp-import" href="/!/x-header-layout/x-header-layout.html">

<link is="pulp-import" href="todo-item.html">

<dom-module id="todo-view">

  <style>

    :host {
      display: block;
    }

    x-header {
      background-color: #4285f4;
      color: #fff;
    }

    [content] {
      padding: 48px;
      max-width: 700px;
      margin: 0 auto;
    }

    [flex] {
      @apply(--layout-flex);
    }

    paper-menu a {
      display: block;
      text-decoration: none;
      min-height: 48px;
      padding-left: 16px;

      @apply(--layout-horizontal);
      @apply(--layout-center);

      /*
      color: var(--menu-link-color);
      font-family: var(--default-font-family);
      -webkit-font-smoothing: antialiased;
      text-rendering: optimizeLegibility;
      font-size: 14px;
      font-weight: 400;
      */
    }

    paper-menu iron-icon {
      margin-right: 33px;
      opacity: 0.54;
    }

  </style>

  <template>

    <x-drawer-layout opened="{{drawer}}">

      <!-- main content -->

      <x-header-layout main>

        <x-header condenses>

          <x-toolbar>
            <paper-icon-button icon="menu" drawer-toggle></paper-icon-button>
            <span flex></span>
            <paper-icon-button disabled="{{!user}}" icon="cloud-off" on-tap="signOutAction"></paper-icon-button>
          </x-toolbar>

          <x-toolbar></x-toolbar>

          <x-toolbar>
            <div spacer title>TodoRedux!</div>
          </x-toolbar>

        </x-header>

        <div content>

          <template is="dom-repeat" items="{{todos}}" as="todo" filter="{{_computeFilter(route)}}">

            <todo-item todo="{{todo}}"></todo-item>

          </template>

        </div>

      </x-header-layout>

      <!-- drawer -->

      <div drawer>

        <x-toolbar>
          <span>Menu</span>
        </x-toolbar>

        <paper-menu attr-for-selected="name" selected="{{route}}" on-tap="closeDrawer">

          <a name="" href="#/">
            <iron-icon icon="assignment"></iron-icon>
            <span>All Todos</span>
          </a>

          <a name="active" href="#/active">
            <iron-icon icon="assignment-late"></iron-icon>
            <span>Active</span>
          </a>

          <a name="completed" href="#/completed">
            <iron-icon icon="assignment-turned-in"></iron-icon>
            <span>Completed</span>
          </a>

        </paper-menu>

      </div>

    </x-drawer-layout>

  </template>

  <script>

    Polymer({

      properties: {

        user: {
          notify: true
        }

      },

      closeDrawer: function() {
        this.drawer = false;
      },

      _computeFilter: function(filterBy) {
        if (filterBy) {
          var ifComplete = (filterBy === 'completed');
          return function(item) {
            return item.isComplete === ifComplete;
          };
        }
      },

      signOutAction: function() {
        this.user = null;
      }

    });

  </script>

</dom-module>
